select 
PROG.PED_IN_CODIGO AS PEDIDO,
USU.GRU_ST_NOME USUARIO_ALTERACAO,
CLI.AGN_ST_FANTASIA CLIENTE,
REP.AGN_ST_FANTASIA REPRESENTANTE,
PED.PED_RE_VALORTOTAL AS VALOR_PEDIDO,
PROG.IPE_DT_DATAENTREGA AS DATA_ENTREGA,
prog.ual_dt_alteracao as DATA_ALTERACAO




from mgven.VEN_PEDPROGENTREGA PROG, MGGLO.GLO_GRUPO_USUARIO USU, 
MGVEN.VEN_PEDIDOVENDA PED, MGGLO.GLO_AGENTES CLI, MGGLO.GLO_AGENTES REP

WHERE USU.GRU_IN_CODIGO = PROG.UAL_IN_CODIGO  -- LINK USUARIO COM PROG
AND PROG.PED_IN_CODIGO = PED.PED_IN_CODIGO    -- LINK PROG C/ PEDIDO
AND PED.CLI_IN_CODIGO = CLI.AGN_IN_CODIGO     -- LINK CLIENTE C/ PEDIDO
AND PED.REP_IN_CODIGO = REP.AGN_IN_CODIGO     -- LINK REPRESENTANTE C/ PEDIDO


AND PROG.UAL_DT_ALTERACAO > '21-JUN-2020' -- PERIODO INICIAL DA DIFERENÇA
AND PROG.UAL_DT_ALTERACAO < '23-JUN-2020'  -- PERIODO FINAL DA DIFERENÇA

--AND PED.TPD_IN_CODIGO IN (1,2) --TPD DE PED VENDA
AND PED.REP_IN_CODIGO = 227
and PROG.IPE_DT_DATAENTREGA not between '01-jun-2020' and '30-jun-2020'-- data de entrega fora do periodo

--AND PED.PED_DT_EMISSAO < '22-JUN-2020' -- APENAS PROGS EDITADAS.

